# pebl

Pebl is a NodeJS middleware starter pack, starting with a complete and working products fetch from a Shopify store.

Each function has an HTTP interface, ready to call locally, or host online and schedule to run automatically.

## Hi!

I'm John! If you're here from Shopify Editions.Dev, welcome to the repo, I hope you find it useful! Feel free to watch or star so I know if I touched any souls today c:

## Intro

Each directory is a platform. 

Each file inside is a function specific to that platform.

Each directory optionally has an `_example.js`. This is a boilerplate function that serves as the starting point for any new functions - which you can create with `npm run new`.

`.creds.yml` is a yaml file to store stuff like credentials for APIs. Use `credsByKey` to access them. The credentials in `.creds.yml` are copied into `.env`, for use by cloud platforms that use that natively (e.g. Google Cloud). When you use `credsByKey`, it augments the environment variables with the credentials for your platform, key and subkey.

`servable.js` is a list of functions that are HTTP-ready. It is generated by finding functions named ending with `Api`, so if you keep a similar structure across all the functions you make, they'll all be able to be called with curl locally, or hosted on a cloud platform.

Functions generally have a mix of mandatory and optional parameters. Put all optional parameters into an object that is the final argument, e.g.

`const doSomething = async (mandatory1, mandatory2, { optional1, optional2 } = {}) => {`

This has a number of benefits:
1. Only supply what you need to use - don't need to skip a param by supplying `undefined`.
1. Optional params have explicit names so you know what they are.
1. `= {}` allows you to supply no options at all.
For further discussion, see [this pen.](https://codepen.io/gorgonfreeman/pen/poYEmOQ)

## How to Use
- Run `npm run dev`. While this is going, all the functions in `servable.js` are available on your localhost, to be triggered with curl commands.
- curl commands are available on all functions - you have to update these so they're accurate to the functions you make.
- Most file changes, except stuff that wouldn't make sense, will trigger `nodemon` to restart the server, so your changes are locally live.
- To develop while something is running, or run something that takes a long time, use `npm run serve` instead. It's the the same thing but the server doesn't restart automatically.